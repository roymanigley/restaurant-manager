import{a as l}from"./chunk-GNVYBFNV.js";import{a as ve,b as _e,c as ge}from"./chunk-UZ2FXXJ4.js";import"./chunk-MZ4LUD7G.js";import"./chunk-TSIVVEAZ.js";import{$ as R,$a as se,A as V,Ab as he,B as h,Ba as Z,C as a,E as $,Fa as ee,Ha as b,J as r,Ja as k,K as n,L as p,M as H,N as S,O as f,S as L,Sa as y,T as m,U,V as q,Va as te,Wa as I,Xa as ie,Ya as re,Za as ne,_a as oe,aa as O,ab as ae,ba as Q,bb as me,ca as z,cb as pe,db as ce,ea as T,eb as le,fb as ue,j as _,ja as x,k as M,l as v,la as J,n as g,o as B,pa as K,pb as de,q as j,r as G,ra as W,v as s,w as c,wa as P,ya as X,za as Y,zb as fe}from"./chunk-ZVRC6D75.js";var ke=e=>[e,"permission"];function we(e,u){e&1&&(r(0,"th"),m(1,"Username"),n(),r(2,"th"),m(3,"Firstname"),n(),r(4,"th"),m(5,"Lastname"),n(),p(6,"th",4))}function Ee(e,u){if(e&1&&(r(0,"td"),p(1,"p-button",6),n()),e&2){let t=f().$implicit;s(),a("rounded",!0)("routerLink",O(2,ke,t.id))}}function Fe(e,u){if(e&1&&(r(0,"td"),m(1),n(),r(2,"td"),m(3),n(),r(4,"td"),m(5),n(),h(6,Ee,2,4,"td",5),Q(7,"async")),e&2){let t=u.$implicit,i=f();s(),U(t.username),s(2),U(t.first_name),s(2),U(t.last_name),s(),a("ngIf",z(7,4,i.hasUpdatePermission$))}}var ye=(()=>{class e{constructor(t,i){this.restaurantUserService=t,this.hasUpdatePermission$=i.hasPermission("core.change_restaurantuser")}static{this.\u0275fac=function(i){return new(i||e)(c(l),c(k))}}static{this.\u0275cmp=g({type:e,selectors:[["app-restaurant-user-list"]],decls:6,vars:3,consts:[["templateColumns",""],["templateRow",""],["header","Restaurant Users"],["permission_model","restaurantuser",3,"service","templateRow","templateColumns"],[2,"width","1%"],[4,"ngIf"],["icon","pi pi-lock-open",3,"rounded","routerLink"]],template:function(i,o){if(i&1&&(r(0,"p-card",2)(1,"app-crud-table",3),h(2,we,7,0,"ng-template",null,0,T)(4,Fe,8,6,"ng-template",null,1,T),n()()),i&2){let d=L(3),F=L(5);s(),a("service",o.restaurantUserService)("templateRow",F)("templateColumns",d)}},dependencies:[x,b,y,Y,fe,J]})}}return e})();var E=class{constructor(u,t,i,o,d,F){this.id=u,this.username=t,this.first_name=i,this.last_name=o,this.restaurant=d,this.permissions=F}};var je=()=>({width:"100%"});function Ge(e,u){if(e&1){let t=H();r(0,"form",2),S("ngSubmit",function(){j(t);let o=f();return G(o.save())}),r(1,"div",3)(2,"div",4)(3,"p-inputGroup")(4,"p-inputGroupAddon"),p(5,"i",5),n(),r(6,"p-floatLabel"),p(7,"input",6),r(8,"label",7),m(9,"Username"),n()()()(),r(10,"div",4)(11,"p-inputGroup")(12,"p-inputGroupAddon"),p(13,"i",5),n(),r(14,"p-floatLabel"),p(15,"p-password",8),r(16,"label",9),m(17,"Password"),n()()()(),r(18,"div",4)(19,"p-inputGroup")(20,"p-inputGroupAddon"),p(21,"i",5),n(),r(22,"p-floatLabel"),p(23,"input",10),r(24,"label",11),m(25,"Firstname"),n()()()(),r(26,"div",4)(27,"p-inputGroup")(28,"p-inputGroupAddon"),p(29,"i",5),n(),r(30,"p-floatLabel"),p(31,"input",12),r(32,"label",13),m(33,"Lastname"),n()()()(),r(34,"div",14),p(35,"p-button",15),r(36,"p-button",16),S("click",function(){j(t);let o=f();return G(o.back())}),n()()()()}if(e&2){let t=f();a("formGroup",t.formGroup),s(15),$(R(7,je)),a("feedback",!1),s(20),a("rounded",!0)("disabled",t.formGroup.invalid),s(),a("rounded",!0)}}var A=(()=>{class e extends ve{constructor(t,i,o,d){super(t,i),this.service=t,this.activatedRoute=i,this.formBuilder=o,this.authService=d}createNewRecord(){let t=new E;return t.restaurant=this.authService.user$.getValue().restaurant,t}initForm(){this.formGroup=this.formBuilder.group({username:[this.record?.username??null,[I.required]],password:[null,[I.required]],first_name:[this.record?.first_name??null,[I.required]],last_name:[this.record?.last_name],restaurant:[this.record?.restaurant,[I.required]]})}static{this.\u0275fac=function(i){return new(i||e)(c(l),c(P),c(ae),c(k))}}static{this.\u0275cmp=g({type:e,selectors:[["app-restaurant-user-detail"]],features:[V],decls:2,vars:1,consts:[["header","Detail"],[3,"formGroup","ngSubmit",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"grid","gap-2"],[1,"lg:col-4","md:col-4","col-12"],[1,"pi","pi-list"],["pInputText","","id","username","formControlName","username"],["for","username"],["id","password","formControlName","password",3,"feedback"],["for","password"],["pInputText","","id","first_name","formControlName","first_name"],["for","first_name"],["pInputText","","id","last_name","formControlName","last_name"],["for","last_name"],[1,"col-12","flex","justify-content-center","gap-3"],["icon","pi pi-save","type","submit",3,"rounded","disabled"],["icon","pi pi-times","type","button","severity","danger",3,"click","rounded"]],template:function(i,o){i&1&&(r(0,"p-card",0),h(1,Ge,37,8,"form",1),n()),i&2&&(s(),a("ngIf",o.formGroup))},dependencies:[x,b,y,me,pe,ce,le,ue,ne,te,ie,re,oe,se],styles:[".p-checkbox,   .p-checkbox-box{height:100%}"]})}}return e})();var Ce=(()=>{class e extends _e{constructor(t){super(t)}static{this.\u0275fac=function(i){return new(i||e)(v(l))}}static{this.\u0275prov=_({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var N=(()=>{class e extends ge{constructor(t,i){super(t,i)}static{this.\u0275fac=function(i){return new(i||e)(v(l),v(X))}}static{this.\u0275prov=_({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Re=(()=>{class e{constructor(t){this.http=t}getBaseUrl(){return"/api/auth/permissions/"}getPermissions(){return this.http.get(this.getBaseUrl(),{params:{offset:0,limit:999}})}static{this.\u0275fac=function(i){return new(i||e)(v(W))}}static{this.\u0275prov=_({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Ie=()=>({height:"30rem"});function Te(e,u){if(e&1&&(r(0,"div",8),m(1),n()),e&2){let t=u.$implicit;s(),q(" ",t.name," ")}}function De(e,u){if(e&1&&(r(0,"p-pickList",6),h(1,Te,2,1,"ng-template",7),n()),e&2){let t=f();a("source",t.notSelectedPermissions)("target",t.selectedPermissions)("dragdrop",!0)("responsive",!0)("sourceStyle",R(6,Ie))("targetStyle",R(7,Ie))}}var Ue=(()=>{class e{constructor(t,i,o){this.service=t,this.activatedRoute=i,this.permissionService=o,this.notSelectedPermissions=[],this.selectedPermissions=[]}ngOnInit(){this.activatedRoute.data.subscribe(t=>{this.record=t.record,this.permissionService.getPermissions().subscribe(i=>{this.initForm(i.results)})})}initForm(t){t?.forEach(i=>{this.record?.permissions?.some(d=>i.app+"."+i.codename===d)?this.selectedPermissions.push(i):this.notSelectedPermissions.push(i)}),console.log(this.notSelectedPermissions),console.log(this.selectedPermissions)}save(){this.service.updatePermissions(this.record?.id,this.selectedPermissions).subscribe(()=>this.back())}back(){history.back()}static{this.\u0275fac=function(i){return new(i||e)(c(l),c(P),c(Re))}}static{this.\u0275cmp=g({type:e,selectors:[["app-restaurant-user-permission"]],decls:6,vars:3,consts:[["header","Detail"],["sourceHeader","Available","targetHeader","Selected","filterBy","name","sourceFilterPlaceholder","Search by name","targetFilterPlaceholder","Search by name","breakpoint","1400px",3,"source","target","dragdrop","responsive","sourceStyle","targetStyle",4,"ngIf"],[1,"grid","gap-2","mt-3"],[1,"col-12","flex","justify-content-center","gap-3"],["icon","pi pi-save","type","button",3,"click","rounded"],["icon","pi pi-times","type","button","severity","danger",3,"click","rounded"],["sourceHeader","Available","targetHeader","Selected","filterBy","name","sourceFilterPlaceholder","Search by name","targetFilterPlaceholder","Search by name","breakpoint","1400px",3,"source","target","dragdrop","responsive","sourceStyle","targetStyle"],["pTemplate","item"],[1,"flex","flex-wrap","p-2","align-items-center","gap-3"]],template:function(i,o){i&1&&(r(0,"p-card",0),h(1,De,2,8,"p-pickList",1),r(2,"div",2)(3,"div",3)(4,"p-button",4),S("click",function(){return o.save()}),n(),r(5,"p-button",5),S("click",function(){return o.back()}),n()()()()),i&2&&(s(),a("ngIf",!!o.selectedPermissions.length||!!o.notSelectedPermissions.length),s(3),a("rounded",!0),s(),a("rounded",!0))},dependencies:[x,ee,b,y,de],styles:[".p-checkbox,   .p-checkbox-box{height:100%}"]})}}return e})();var Ae=[{path:"",component:ye,resolve:{records:Ce},runGuardsAndResolvers:"pathParamsOrQueryParamsChange"},{path:"new",component:A},{path:":id/permission",component:Ue,resolve:{record:N}},{path:":id",component:A,resolve:{record:N}}],dt=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=B({type:e})}static{this.\u0275inj=M({imports:[K,he,Z.forChild(Ae)]})}}return e})();export{dt as RestaurantUserModule};
