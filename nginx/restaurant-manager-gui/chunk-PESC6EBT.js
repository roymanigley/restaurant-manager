import{a as W}from"./chunk-APYTP6AD.js";import{a as _}from"./chunk-HFWTKFKQ.js";import{a as H}from"./chunk-GNVYBFNV.js";import{a as be,b as xe,c as Ce}from"./chunk-UZ2FXXJ4.js";import"./chunk-MZ4LUD7G.js";import"./chunk-TSIVVEAZ.js";import{$a as V,A as oe,Ab as he,B as u,Ba as ce,C as l,Fa as A,G as ne,Ha as F,J as i,Ja as se,K as o,L as c,M as y,N as w,O as s,S as X,Sa as E,T as a,U as h,V as Y,W as T,Wa as v,Xa as k,Ya as j,Za as q,_a as M,ab as L,ba as Z,bb as B,cb as $,da as ee,db as U,ea as te,hb as P,ib as de,j as N,ja as R,jb as Q,k as ie,kb as ue,l as G,lb as fe,n as C,na as ae,o as re,pa as le,q as S,qb as z,r as g,u as D,v as n,w as d,wa as me,xb as _e,ya as pe,zb as ve}from"./chunk-ZVRC6D75.js";function Oe(t,m){t&1&&(i(0,"th"),a(1,"Table"),o(),i(2,"th"),a(3,"Start"),o(),i(4,"th"),a(5,"End"),o())}function Ne(t,m){if(t&1&&(i(0,"td"),a(1),o(),i(2,"td"),a(3),Z(4,"date"),o(),i(5,"td"),a(6),Z(7,"date"),o()),t&2){let e=m.$implicit,r=s();n(),h(e.table_name),n(2),h(ee(4,3,e.start,r.DATE_TIME_FORMAT)),n(3),h(ee(7,6,e.end,r.DATE_TIME_FORMAT))}}var we=(()=>{class t{constructor(e){this.occupationService=e,this.DATE_TIME_FORMAT=_e}static{this.\u0275fac=function(r){return new(r||t)(d(_))}}static{this.\u0275cmp=C({type:t,selectors:[["app-occupation-list"]],decls:6,vars:3,consts:[["templateColumns",""],["templateRow",""],["header","Occupations"],["permission_model","occupation",3,"service","templateRow","templateColumns"]],template:function(r,p){if(r&1&&(i(0,"p-card",2)(1,"app-crud-table",3),u(2,Oe,6,0,"ng-template",null,0,te)(4,Ne,8,9,"ng-template",null,1,te),o()()),r&2){let f=X(3),b=X(5);n(),l("service",p.occupationService)("templateRow",b)("templateColumns",f)}},dependencies:[E,ve,ae]})}}return t})();var I=class{constructor(m,e,r,p,f,b,x,ye){this.id=m,this.start=e,this.end=r,this.table_name=p,this.table=f,this.waiter=b,this.waiter_first_name=x,this.waiter_last_name=ye}};var K={production:!0,appBaseUrl:"https://restaurant-manager.eutima.ch/#"};function Ue(t,m){if(t&1&&(i(0,"div",21)(1,"div"),a(2),o()()),t&2){let e=m.$implicit;n(2),T("",e.first_name," ",e.last_name,"")}}function Pe(t,m){if(t&1&&(i(0,"div",21)(1,"div"),a(2),o()()),t&2){let e=m.$implicit;n(2),T("",e.first_name," ",e.last_name,"")}}function Qe(t,m){if(t&1&&(i(0,"div",22)(1,"a",23),a(2),o(),c(3,"qrcode",24),o()),t&2){let e=s(2);n(),l("href",e.qrCode,D),n(),h(e.record==null?null:e.record.id),n(),l("qrdata",e.qrCode)}}function ze(t,m){if(t&1){let e=y();i(0,"form",2),w("ngSubmit",function(){S(e);let p=s();return g(p.save())}),i(1,"div",3)(2,"div",4)(3,"p-inputGroup")(4,"p-inputGroupAddon"),c(5,"i",5),o(),i(6,"p-floatLabel"),c(7,"p-dropdown",6),i(8,"label",7),a(9,"Table"),o()()()(),i(10,"div",4)(11,"p-inputGroup")(12,"p-inputGroupAddon"),c(13,"i",5),o(),i(14,"p-floatLabel")(15,"p-dropdown",8),u(16,Ue,3,2,"ng-template",9)(17,Pe,3,2,"ng-template",10),o(),i(18,"label",11),a(19,"Waiter"),o()()()(),i(20,"div",4)(21,"p-inputGroup")(22,"p-inputGroupAddon"),c(23,"i",12),o(),i(24,"p-floatLabel"),c(25,"p-calendar",13),i(26,"label",14),a(27,"Start"),o()()()(),i(28,"div",4)(29,"p-inputGroup")(30,"p-inputGroupAddon"),c(31,"i",12),o(),i(32,"p-floatLabel"),c(33,"p-calendar",15),i(34,"label",16),a(35,"End"),o()()()(),u(36,Qe,4,3,"div",17),i(37,"div",18),c(38,"p-button",19),i(39,"p-button",20),w("click",function(){S(e);let p=s();return g(p.back())}),o()()()()}if(t&2){let e=s();l("formGroup",e.formGroup),n(7),l("options",e.tables),n(8),l("options",e.waiters),n(10),l("maxDate",e.formGroup.value.end)("showTime",!0),n(8),l("showTime",!0),n(3),l("ngIf",e.qrCode),n(2),l("rounded",!0)("disabled",e.formGroup.invalid),n(),l("rounded",!0)}}var Te=(()=>{class t extends be{constructor(e,r,p,f,b){super(e,f),this.service=e,this.tableService=r,this.restaurantUserService=p,this.activatedRoute=f,this.formBuilder=b,this.tables=[],this.waiters=[],this.tableService.fetchAllRecords(0,999).subscribe(x=>this.tables=x.results),this.restaurantUserService.fetchAllRecords(0,999).subscribe(x=>this.waiters=x.results)}createNewRecord(){return new I}initForm(){this.record?.id&&(this.qrCode=`${K.appBaseUrl}/guest/occupation/${this.record.id}`),this.formGroup=this.formBuilder.group({table:[this.record?.table??null,[v.required]],waiter:[this.record?.waiter??null,[v.required]],start:[this.record?.start??null,[v.required]],end:[this.record?.end??null]})}static{this.\u0275fac=function(r){return new(r||t)(d(_),d(W),d(H),d(me),d(L))}}static{this.\u0275cmp=C({type:t,selectors:[["app-occupation-detail"]],features:[oe],decls:2,vars:1,consts:[["header","Detail"],[3,"formGroup","ngSubmit",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"grid","gap-2"],[1,"lg:col-4","md:col-4","col-12"],[1,"pi","pi-list"],["id","table","formControlName","table","optionValue","id","optionLabel","name",3,"options"],["for","table"],["id","waiter","formControlName","waiter","optionValue","id",3,"options"],["pTemplate","selectedItem"],["pTemplate","item"],["for","waiter"],[1,"pi","pi-clock"],["id","start","formControlName","start",3,"maxDate","showTime"],["for","start"],["id","end","formControlName","end",3,"showTime"],["for","end"],["class","lg:col-8 md:col-8 col-12",4,"ngIf"],[1,"col-12","flex","justify-content-center","gap-3"],["icon","pi pi-save","type","submit",3,"rounded","disabled"],["icon","pi pi-times","type","button","severity","danger",3,"click","rounded"],[1,"flex","align-items-center","gap-2"],[1,"lg:col-8","md:col-8","col-12"],["target","_blank",3,"href"],[3,"qrdata"]],template:function(r,p){r&1&&(i(0,"p-card",0),u(1,ze,40,10,"form",1),o()),r&2&&(n(),l("ngIf",p.formGroup))},dependencies:[R,A,F,E,B,$,U,Q,q,k,j,z,M,V,P],styles:[".p-checkbox,   .p-checkbox-box{height:100%}"]})}}return t})();var Ee=(()=>{class t extends xe{constructor(e){super(e)}static{this.\u0275fac=function(r){return new(r||t)(G(_))}}static{this.\u0275prov=N({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Ie=(()=>{class t extends Ce{constructor(e,r){super(e,r)}static{this.\u0275fac=function(r){return new(r||t)(G(_),G(pe))}}static{this.\u0275prov=N({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function We(t,m){if(t&1&&(i(0,"div",21)(1,"div"),a(2),o()()),t&2){let e=m.$implicit;n(2),T("",e.first_name," ",e.last_name,"")}}function He(t,m){if(t&1&&(i(0,"div",21)(1,"div"),a(2),o()()),t&2){let e=m.$implicit;n(2),T("",e.first_name," ",e.last_name,"")}}function Je(t,m){t&1&&(i(0,"tr"),c(1,"th",22),i(2,"th"),a(3," Table "),o(),i(4,"th"),a(5," Seats "),o()())}function Ke(t,m){if(t&1){let e=y();i(0,"tr")(1,"td")(2,"div",23)(3,"p-button",24),w("click",function(){let p=S(e).$implicit,f=s(3);return g(f.select(p.id))}),o()()(),i(4,"td"),a(5),o(),i(6,"td"),a(7),o()()}if(t&2){let e=m.$implicit,r=s(3);n(3),l("disabled",!(r.formGroup.value!=null&&r.formGroup.value.waiter)||!(r.formGroup.value!=null&&r.formGroup.value.start))("rounded",!0),n(2),Y(" ",e.name," "),n(2),Y(" ",e.seats," ")}}function Xe(t,m){if(t&1&&(i(0,"div",6)(1,"p-inputGroup")(2,"p-inputGroupAddon"),c(3,"i",7),o(),i(4,"p-floatLabel")(5,"p-dropdown",8),u(6,We,3,2,"ng-template",9)(7,He,3,2,"ng-template",10),o(),i(8,"label",11),a(9,"Waiter"),o()()()(),i(10,"div",6)(11,"p-inputGroup")(12,"p-inputGroupAddon"),c(13,"i",12),o(),i(14,"p-floatLabel"),c(15,"p-calendar",13),i(16,"label",14),a(17,"Start"),o()()()(),i(18,"div",15)(19,"p-inputGroup")(20,"p-inputGroupAddon"),c(21,"i",7),o(),i(22,"p-floatLabel"),c(23,"p-inputNumber",16),i(24,"label",17),a(25,"Enter the number of seats"),o()()()(),i(26,"div",15)(27,"p-table",18),u(28,Je,6,0,"ng-template",19)(29,Ke,8,4,"ng-template",20),o()()),t&2){let e=s(2);n(5),l("options",e.waiters),n(10),l("showTime",!0),n(12),l("value",e.tablesFiltered)}}function Ye(t,m){if(t&1&&(i(0,"div",15)(1,"a",26),a(2),o(),c(3,"qrcode",27),o()),t&2){let e=s(3);n(),l("href",e.qrCode,D),n(),h(e.record.id),n(),l("qrdata",e.qrCode)}}function Ze(t,m){if(t&1&&u(0,Ye,4,3,"div",25),t&2){let e=s(2);l("ngIf",e.qrCode)}}function et(t,m){if(t&1){let e=y();i(0,"form",2)(1,"div",3),u(2,Xe,30,3)(3,Ze,1,1),i(4,"div",4)(5,"p-button",5),w("click",function(){S(e);let p=s();return g(p.back())}),o()()()()}if(t&2){let e=s();l("formGroup",e.formGroup),n(2),ne(2,e.qrCode?3:2),n(3),l("rounded",!0)}}var Ge=(()=>{class t{constructor(e,r,p,f,b){this.service=e,this.tableService=r,this.restaurantUserService=p,this.formBuilder=f,this.authService=b,this.tables=[],this.tablesFiltered=[],this.waiters=[],this.record=new I,this.now=new Date,this.fetchAvailableTables(this.now),this.restaurantUserService.fetchAllRecords(0,999).subscribe(x=>this.waiters=x.results)}fetchAvailableTables(e){this.tableService.fetchAvailable(e).subscribe(r=>{this.tables=r.results,this.filterSeats(this.formGroup?.value?.seats)})}ngOnInit(){this.initForm(),this.formGroup?.controls.start.valueChanges.subscribe(e=>{e?this.fetchAvailableTables(e):(this.tables=[],this.tablesFiltered=[])}),this.formGroup?.controls.seats.valueChanges.subscribe(e=>{this.filterSeats(e)})}filterSeats(e){e<1?this.tablesFiltered=[]:this.tablesFiltered=this.tables.filter(r=>r.seats>=e)}initForm(){this.formGroup=this.formBuilder.group({table:[this.record?.table??null,[v.required]],waiter:[this.record?.waiter??this.authService.user$.getValue()?.id,[v.required]],start:[this.record?.start??this.now,[v.required]],seats:[null,[v.required]]})}select(e){this.formGroup?.patchValue({table:e}),this.formGroup?.valid&&this.save()}save(){this.service.create(this.formGroup?.value).subscribe(e=>{this.record=e,this.record?.id&&(this.qrCode=`${K.appBaseUrl}/guest/occupation/${this.record.id}`)})}back(){history.back()}static{this.\u0275fac=function(r){return new(r||t)(d(_),d(W),d(H),d(L),d(se))}}static{this.\u0275cmp=C({type:t,selectors:[["app-occupation-new"]],decls:2,vars:1,consts:[["header","Detail"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"grid","gap-2"],[1,"col-12","flex","justify-content-center","gap-3"],["icon","pi pi-times","type","button","severity","danger",3,"click","rounded"],[1,"lg:col-4","md:col-4","col-12"],[1,"pi","pi-list"],["id","waiter","formControlName","waiter","optionValue","id",3,"options"],["pTemplate","selectedItem"],["pTemplate","item"],["for","waiter"],[1,"pi","pi-clock"],["id","start","formControlName","start",3,"showTime"],["for","start"],[1,"lg:col-8","md:col-8","col-12"],["id","seats","formControlName","seats"],["for","seats"],[3,"value"],["pTemplate","header"],["pTemplate","body"],[1,"flex","align-items-center","gap-2"],[1,"w-1"],[1,"flex","gap-2"],["icon","pi pi-check",3,"click","disabled","rounded"],["class","lg:col-8 md:col-8 col-12",4,"ngIf"],["target","_blank",3,"href"],[3,"qrdata"]],template:function(r,p){r&1&&(i(0,"p-card",0),u(1,et,6,3,"form",1),o()),r&2&&(n(),l("ngIf",p.formGroup))},dependencies:[R,A,F,E,B,$,U,ue,fe,Q,q,k,j,z,M,V,P],styles:[".p-checkbox,   .p-checkbox-box{height:100%}"]})}}return t})();var tt=[{path:"",component:we,resolve:{records:Ee},runGuardsAndResolvers:"pathParamsOrQueryParamsChange"},{path:"new",component:Ge},{path:":id",component:Te,resolve:{record:Ie}}],Rt=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=re({type:t})}static{this.\u0275inj=ie({imports:[le,he,ce.forChild(tt),de]})}}return t})();export{Rt as OccupationModule};
