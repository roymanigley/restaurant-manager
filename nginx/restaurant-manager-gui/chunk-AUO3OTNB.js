import{b as C}from"./chunk-MZ4LUD7G.js";import{a as V}from"./chunk-TSIVVEAZ.js";import{$ as J,Ab as oe,B as v,Ba as te,C as s,D as q,Fa as B,Ha as N,J as n,K as o,L as _,M as Y,N as u,O as f,T as l,U as c,W as k,aa as K,ba as g,c as O,d as T,da as h,e as Z,f as F,h as x,ha as Q,ia as A,j as b,k as H,n as R,o as W,oa as j,pa as X,q as I,qa as P,r as S,rb as L,s as w,sb as ie,tb as re,u as U,ub as ne,v as a,w as d,wa as D,wb as $,yb as G,za as ee}from"./chunk-ZVRC6D75.js";var ae=(()=>{class i extends C{getBaseUrl(){return"/api/guests/items"}getItems(e,t,r,m){let E=new P().append("offset",r).append("limit",m);return this.http.get(`${this.getBaseUrl()}/available/${e}/${t}/`,{params:E}).pipe(x(pe=>pe.results.forEach(de=>de.amount=0)))}static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=w(i)))(r||i)}})()}static{this.\u0275prov=b({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var M=(()=>{class i extends C{getBaseUrl(){return"/api/guests/orders"}fetchOrders(e,t=0,r=25){let m=new P().append("offset",t).append("size",r);return this.http.get(`${this.getBaseUrl()}/${e}/`,{params:m})}createOrder(e,t,r){let m={item:t,amount:r};return this.http.post(`${this.getBaseUrl()}/${e}/add/`,m)}static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=w(i)))(r||i)}})()}static{this.\u0275prov=b({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var le=(()=>{class i extends C{getBaseUrl(){return"/api/guests/occupations"}static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=w(i)))(r||i)}})()}static{this.\u0275prov=b({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var we=()=>["orders"],Ce=i=>({"border-top-1 surface-border":i});function Ee(i,p){if(i&1){let e=Y();n(0,"div",12)(1,"div",13)(2,"div",14),_(3,"img",15),o(),n(4,"div",16)(5,"div",17)(6,"div")(7,"span",18),l(8),o(),n(9,"div",19),l(10),o(),n(11,"div",19),l(12),o()()(),n(13,"div",20)(14,"span",21),l(15),g(16,"currency"),o(),n(17,"div",22)(18,"div",23)(19,"p-button",24),u("click",function(){let r=I(e).$implicit;return S(r.amount=r.amount-1)}),o(),n(20,"span",25),l(21),o(),n(22,"p-button",26),u("click",function(){let r=I(e).$implicit;return S(r.amount=r.amount+1)}),o()(),n(23,"p-button",27),u("click",function(){let r=I(e).$implicit,m=f(3);return S(m.order(r))}),o()()()()()()}if(i&2){let e,t=p.$implicit,r=p.first,m=f(3);a(),s("ngClass",K(18,Ce,!r)),a(2),s("src",t.image,U)("alt",t.name),a(5),c(t.category),a(2),c(t.name),a(2),c(t.description),a(3),c(h(16,15,t.price,m.DEFAULT_CURRENCY)),a(4),s("rounded",!0)("outlined",!0)("disabled",t.amount<1),a(2),c((e=t.amount)!==null&&e!==void 0?e:0),a(),s("rounded",!0)("outlined",!0)("disabled",t.amount>4),a(),s("disabled",t.amount<1)}}function Ie(i,p){if(i&1&&(n(0,"div",10),v(1,Ee,24,20,"div",11),o()),i&2){let e=p.$implicit;a(),s("ngForOf",e)}}function Se(i,p){if(i&1){let e=Y();n(0,"p-tabPanel",4)(1,"p-button",5),u("click",function(){let r=I(e).$implicit,m=f();return S(m.loadItems(r))}),o(),n(2,"div",6),_(3,"p-button",7),o(),n(4,"p-dataView",8),v(5,Ie,2,1,"ng-template",9),o()()}if(i&2){let e=p.$implicit,t=f();s("header",e)("disabled",t.loading),a(3),s("rounded",!0)("routerLink",J(7,we)),a(),s("value",t.items)("rows",t.DEFAULT_PAGE_SIZE)("loading",t.loading)}}var me=(()=>{class i{constructor(e,t,r,m,E){this.guestItemService=e,this.guestOrderService=t,this.guestOccupationService=r,this.activatedRoute=m,this.notificationService=E,this.items=[],this.loading=!0,this.totalRecords=0,this.DEFAULT_CURRENCY=$,this.DEFAULT_PAGE_SIZE=25,this.CATEGORIES=G}ngOnInit(){this.activatedRoute.params.pipe(T(e=>e.id),x(e=>this.id=e),Z(e=>this.guestOccupationService.fetchById(e))).subscribe(e=>{this.occupation=e,this.loadItems(G[0])})}order(e){this.loading=!0,this.guestOrderService.createOrder(this.id,e.id,e.amount).subscribe({next:()=>{this.notificationService.showInfo("ordered: "+e.name),this.loading=!1},error:t=>{console.error(t),this.notificationService.showError("failed to add: "+e.name),this.loading=!1}}),e.amount=0}loadItems(e){this.loading=!0,this.guestItemService.getItems(this.id,e,0,999999).pipe(F(t=>(this.notificationService.showError(t.error.detail),O({count:0,results:[]})))).subscribe(t=>{this.totalRecords=t.count,this.items=t.results,this.loading=!1})}onTabChange(e){this.loadItems(G[e.index])}static{this.\u0275fac=function(t){return new(t||i)(d(ae),d(M),d(le),d(D),d(V))}}static{this.\u0275cmp=R({type:i,selectors:[["app-items-overview"]],decls:7,vars:4,consts:[[1,"card"],[1,"mb-2"],[3,"onChange","scrollable"],[3,"header","disabled",4,"ngFor","ngForOf"],[3,"header","disabled"],["icon","pi pi-refresh",3,"click"],[1,"flex","justify-content-end","mr-3","mb-1"],["size","large","icon","pi pi-shopping-cart",3,"rounded","routerLink"],[3,"value","rows","loading"],["pTemplate","list"],[1,"grid","grid-nogutter"],["class","col-12",4,"ngFor","ngForOf"],[1,"col-12"],[1,"flex","flex-column","sm:flex-row","sm:align-items-center","p-4","gap-3",3,"ngClass"],[1,"md:w-10rem","relative"],[1,"block","xl:block","mx-auto","border-round","w-full",3,"src","alt"],[1,"flex","flex-column","md:flex-row","justify-content-between","md:align-items-center","flex-1","gap-4"],[1,"flex","flex-row","md:flex-column","justify-content-between","align-items-start","gap-2"],[1,"font-medium","text-secondary","text-sm"],[1,"text-lg","font-medium","text-900","mt-2"],[1,"flex","flex-column","md:align-items-end","gap-5"],[1,"text-xl","font-semibold","text-900"],[1,"flex","flex-row-reverse","md:flex-row","gap-2"],[1,"flex","align-items-center"],["icon","pi pi-minus-circle",3,"click","rounded","outlined","disabled"],[1,"mr-1","ml-1",2,"font-size","2em"],["icon","pi pi-plus-circle",3,"click","rounded","outlined","disabled"],["icon","pi pi-shopping-cart","label","Buy Now",1,"flex-auto","md:flex-initial","white-space-nowrap",3,"click","disabled"]],template:function(t,r){t&1&&(n(0,"div",0)(1,"div",1)(2,"strong"),l(3,"Waiter:"),o(),l(4),o(),n(5,"p-tabView",2),u("onChange",function(E){return r.onTabChange(E)}),v(6,Se,6,8,"p-tabPanel",3),o()()),t&2&&(a(4),k(" ",r.occupation==null?null:r.occupation.waiter_first_name," ",r.occupation==null?null:r.occupation.waiter_last_name," "),a(),s("scrollable",!0),a(),s("ngForOf",r.CATEGORIES))},dependencies:[Q,A,B,N,L,ne,re,ee,j]})}}return i})();function ye(i,p){if(i&1&&(n(0,"div",5)(1,"div",6)(2,"div",7),_(3,"img",14)(4,"p-tag",15),o(),n(5,"div",9)(6,"div",10)(7,"div")(8,"div",16),l(9),o()()(),n(10,"div",11)(11,"span",17),l(12),g(13,"currency"),o(),n(14,"span",8),l(15),g(16,"currency"),o()()()()()),i&2){let e=p.$implicit,t=f(2);a(3),s("src",e.item_image,U)("alt",e.name),a(),q("left",4,"px")("top",4,"px"),s("value",e.state),a(5),c(e.item_name),a(3),k("",e.amount," x ",h(13,11,e.price_per_item,t.DEFAULT_CURRENCY),""),a(3),c(h(16,14,e.price_per_item*e.amount,t.DEFAULT_CURRENCY))}}function Oe(i,p){if(i&1&&(n(0,"div",4)(1,"div",5)(2,"div",12)(3,"div",7)(4,"span",8),l(5,"Total:"),o()(),n(6,"div",9),_(7,"div",10),n(8,"div",11)(9,"span",8),l(10),g(11,"currency"),o()()()()()(),n(12,"div",4),v(13,ye,17,17,"div",13),o()),i&2){let e=p.$implicit,t=f();a(10),c(h(11,2,t.totalCost,t.DEFAULT_CURRENCY)),a(3),s("ngForOf",e)}}var ce=(()=>{class i{constructor(e,t,r){this.guestOrderService=e,this.activatedRoute=t,this.notificationService=r,this.orders=[],this.loading=!0,this.totalRecords=0,this.totalCost=0,this.DEFAULT_CURRENCY=$}ngOnInit(){this.activatedRoute.params.pipe(T(e=>e.id),x(e=>this.id=e)).subscribe(e=>this.loadItems())}loadItems(){this.loading=!0,this.guestOrderService.fetchOrders(this.id,0,99999).pipe(F(e=>(this.notificationService.showError(e.error.detail),O({count:0,results:[]})))).subscribe(e=>{this.totalRecords=e.count,this.orders=e.results,this.totalCost=this.orders.reduce((t,r)=>t+(r.amount??0)*(r.price_per_item??0),0),this.loading=!1})}static{this.\u0275fac=function(t){return new(t||i)(d(M),d(D),d(V))}}static{this.\u0275cmp=R({type:i,selectors:[["app-order-overview"]],decls:16,vars:7,consts:[[1,"card"],["icon","pi pi-refresh",3,"click"],[3,"value","totalRecords","loading"],["pTemplate","list"],[1,"grid","grid-nogutter"],[1,"col-12"],[1,"flex","flex-column","sm:flex-row","sm:align-items-center","p-4","gap-3","border-top-1","surface-border"],[1,"md:w-10rem","relative"],[1,"text-xl","font-semibold","text-900"],[1,"flex","flex-column","md:flex-row","justify-content-between","md:align-items-center","flex-1","gap-4"],[1,"flex","flex-row","md:flex-column","justify-content-between","align-items-start","gap-2"],[1,"flex","flex-column","md:align-items-end","gap-5"],[1,"flex","flex-column","sm:flex-row","sm:align-items-center","p-4","gap-3"],["class","col-12",4,"ngFor","ngForOf"],[1,"block","xl:block","mx-auto","border-round","w-full",3,"src","alt"],[1,"absolute",3,"value"],[1,"text-l","font-semibold","text-900","mt-2"],[1,"text-l","font-semibold","text-600"]],template:function(t,r){t&1&&(n(0,"div",0)(1,"p-button",1),u("click",function(){return r.loadItems()}),o(),n(2,"p-dataView",2),v(3,Oe,14,5,"ng-template",3),o(),n(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"span",8),l(9,"Total:"),o()(),n(10,"div",9),_(11,"div",10),n(12,"div",11)(13,"span",8),l(14),g(15,"currency"),o()()()()()()()),t&2&&(a(2),s("value",r.orders)("totalRecords",r.totalRecords)("loading",r.loading),a(12),c(h(15,4,r.totalCost,r.DEFAULT_CURRENCY)))},dependencies:[A,B,N,L,ie,j]})}}return i})();var Te=[{path:":id",component:me},{path:":id/orders",component:ce}],qe=(()=>{class i{static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275mod=W({type:i})}static{this.\u0275inj=H({imports:[X,oe,te.forChild(Te)]})}}return i})();export{qe as OrderModule};
