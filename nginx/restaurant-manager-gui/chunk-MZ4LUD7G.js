import{a as l}from"./chunk-TSIVVEAZ.js";import{f as a,h as e,j as h,l as n,ra as p}from"./chunk-ZVRC6D75.js";var o=class{static fromUtcIsoString(c){return new Date(c)}static fromDateToUtcIsoString(c){return c.toISOString()}};var T=(()=>{class s{constructor(i,t){this.http=i,this.notificationService=t}getDateFields(){return[]}fetchAllRecords(i=0,t=20){return this.http.get(`${this.getBaseUrl()}/`,{params:{offset:i,limit:t}}).pipe(e(r=>r.results.forEach(f=>this.mapStringsToDate(f))))}fetchById(i){return this.http.get(`${this.getBaseUrl()}/${i}/`).pipe(e(t=>this.mapStringsToDate(t)))}create(i){return this.mapDatesToString(i),this.setEmptyFieldsToNull(i),this.http.post(`${this.getBaseUrl()}/`,i).pipe(a(t=>{throw this.notificationService.showError("create failed: "+t.status),t}),e(()=>this.notificationService.showSuccess("record created")),e(t=>this.mapStringsToDate(t)))}update(i,t){return this.mapDatesToString(t),this.setEmptyFieldsToNull(t),this.http.put(`${this.getBaseUrl()}/${i}/`,t).pipe(a(r=>{throw this.notificationService.showError("update failed: "+r.status),r}),e(()=>this.notificationService.showSuccess("record updated")),e(r=>this.mapStringsToDate(r)))}delete(i){return this.http.delete(`${this.getBaseUrl()}/${i}/`).pipe(a(t=>{throw this.notificationService.showError("delete failed: "+t.status),t}),e(()=>this.notificationService.showSuccess("record deleted")))}mapStringsToDate(i){Object.keys(i).filter(t=>this.getDateFields().includes(t)).filter(t=>!!i[t]).forEach(t=>i[t]=o.fromUtcIsoString(i[t]))}mapDatesToString(i){Object.keys(i).filter(t=>this.getDateFields().includes(t)).filter(t=>!!i[t]).forEach(t=>i[t]=o.fromDateToUtcIsoString(i[t]))}setEmptyFieldsToNull(i){Object.keys(i).filter(t=>!i[t]).forEach(t=>i[t]=null)}static{this.\u0275fac=function(t){return new(t||s)(n(p),n(l))}}static{this.\u0275prov=h({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();export{o as a,T as b};
